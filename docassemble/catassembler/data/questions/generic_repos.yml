include:
  - nav.yml
  - shared.yml
---
modules:
  - .get_repositories
  - .parse_cli_args
---
mandatory: True
code: |
  show_repo_info
  show_args
  arg_download
---
continue button field: show_args
question: |
  ${ current_repo['name'] }
fields: 
  code: arg_fields
---
event: arg_download
question: |
  Next steps
subquestion: |

  ## Run on Google Colab
  1. Open a new notebook on [Google Colab](https://colab.new)
  2. Paste the below command to install the package and run the cell
  ```
  !pip install ${ current_repo['name'] }
  ```
  4. You can now run the script by simply pasting and running the below in a different cell
  
  ```
  ${ current_repo['name'] }
  % for arg in args:
    % if arg['flag']:
      ${ "--" + arg['name'] }
    % endif
    ${ all_variables()[arg['name']] }
  % endfor
  ```
  
  % if current_repo['readme']:
  ${ display_template(template, scrollable=True, collapse=True) }
  % endif
  
  ${ action_button_html(current_repo['url'], label="View on Github") }
--- 
code: |
  arg_fields = []
  
  for arg in args: 
    arg_fields.append({
      "label": arg.get("help_text", "Developer didn't add help text :("),
      "field": arg['name'].replace("-","_")
    })
---
continue button field: show_repo_info
question: |
  ${ current_repo['name'] } 
subquestion: |
  ${ current_repo['description'] } 
  
  ${ current_repo['license'] }
  
  % if current_repo['readme']:
  ${ display_template(template, scrollable=True, collapse=True) }
  % endif
  
  ${ action_button_html(current_repo['url'], label="View on Github") }
---
#% if current_repo['name'] == "instagram-location-search":
#${ action_button_html(interview_url(i=user_info().package + ":instagram-location-search.yml", reset=1), label="Run instagram-location-search") }
#% endif
---
template: template
subject: README
content: |
  ${ current_repo['readme'] }
---
code: |
  repos = fetch_bellingcat_repos()
  current_repo = None
  
  for repo in repos: 
    if url_args.get('name') == repo['name']:
      current_repo = repo
      
  args = get_cli_args(current_repo)
---